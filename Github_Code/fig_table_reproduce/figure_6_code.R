# code for Figure 4 in the main text 

# ============================================================================================================
# ============================================================================================================
# Load library and functions
# ============================================================================================================
# ============================================================================================================
require(ggplot2);
source('user_functions.R');

# ============================================================================================================
# ============================================================================================================
# load summarized MCMC output #
# ============================================================================================================
# ============================================================================================================
load("/result/Casrto_reproduce_figure.Rdata")


# ========================================================================================
# ========================================================================================
# generate the plots 
# ========================================================================================
# ========================================================================================
c_gamma = BayFDR(PPI_keep, alpha = 0.05)
taxa.name.p = taxa.name.pp[flag == 0]

# 95% credible interval #
CIalpha.plot(PPI = PPI_keep, tax.name.full = taxa.name.p, log_r_mat = lalpha_mat, alpha.sig = 0.05)

# marginal posterior of inclusion #
gamma.PPI.draw(gamma.PPI = PPI_keep, tax.name.full = taxa.name.p, alpha.sig = 0.05)

# cladogram #
# separate tree plot #
taxa.all = taxa.name.p
taxa.sig = taxa.all[PPI_keep > c_gamma]
taxa.sig.control = taxa.sig[c( 1, 4, 5, 7 )]
taxa.sig.case = taxa.sig[-c(1, 4, 5, 7)]
tree.plot(controln= taxa.sig.control, casen = taxa.sig.case)


